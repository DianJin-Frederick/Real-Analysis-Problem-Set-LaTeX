\section{$\R$上的勒贝格外测度与测度的构造}
\subsection{正课内容总结}

在正课中, 我们首先从区间这一类$\R$中最简单的集合出发, 定义了有界区间的\textbf{长度}. 若$a,b \in \R, a < b$, 则定义
$(a,b), [a,b], (a,b], [a,b)$的\textbf{长度}均为$b-a$, 即
$$|(a,b)| = |[a,b]| = |(a,b]| = |[a,b)| = b-a. $$
接着我们利用下确界定义了所有集合的勒贝格外测度, 再使用Carath\'eorody条件加以限制, 得到了$\calP(\R)$的一个真子族: 勒贝格可测集构成的集族. 
我们以开区间构成定理为基础, 利用开区间覆盖以及下确界定义了$\R$上的勒贝格外测度, 再利用\textbf{Carath\'eodory条件}加以限制得到勒贝格测度. 勒贝格测度$m$满足以下性质:
\begin{enumerate}
    \item  $m(\varnothing) = 0$;
    \item (可数可加性)若$\{E_n\}$是一列互不相交的可测集, 则
    $$m\br{\bCup{n=1}{\infty}E_n} = \Sum{n=1}{\infty}m(E_n).$$
\end{enumerate}
可测集族满足以下性质:
\begin{enumerate}
    \item 空集和$\R^n$可测;
    \item 若$\{E_n\}$是一列可测集, 则$\bCup{n=1}{\infty}E_n$可测;
    \item 若$E$可测, 则$E^c$可测.
\end{enumerate}
由此我们得到了$\R$上的一种集合-代数结构: 勒贝格$\sigma$-代数. 我们可以将勒贝格测度与勒贝格$\sigma$-代数推广至一般的集合. 
$m$做了哪些事? 输入一个可测集$E$, $m(E)$便返回一个值, 该值属于$[0,\infty]$ (注意$\infty$可以取到, 例如$m(\R) = \infty$). 
于是得到元素间的对应关系$E \mapsto m(E)$. 
\begin{exercise}
    找出$m$的定义域与值域, 将$m$这个映射写成标准形式. 
\end{exercise}
设$X$是一个集合, $\calM$是$X$的一些子集构成的集族. 如果$\{E_n\}_{n=1}^\infty \subset \calM \implies \bCup{n=1}{\infty}E_n \in \calM$且$E \in \calM \implies E^c \in \calM$, 则称$\calM$为$X$上的一个$\sigma$-代数, $\calM$中的元素称为\textbf{可测集}. 
而抽象测度正是定义在$\calM$上的一个可数可加的函数: 设$\mu: \calM \to [0, \infty]$, 如果$\mu$满足
\begin{enumerate}
    \item $\mu(\varnothing) = 0$;
    \item 若$\{E_n\}$是一列互不相交的可测集, 则
    $$\mu\br{\bCup{n=1}{\infty}E_n} = \Sum{n=1}{\infty}\mu(E_n),$$
\end{enumerate}
那么称$\mu$为$\calM$上的一个\textbf{测度}.

不难发现, 体积和外测度实际上也是定义在某些集族上的函数:
体积\footnote{这里直接当成日常生活中(推广至$d$维)的体积即可, 并且仅定义在方体, 矩体上}定义在方体构成的集族上, 外测度定义在所有幂集上, 测度定义在$\sigma$-代数上.
现在我们从上节的构造过程归纳出重要步骤, 厘清如何从简单到复杂. 
我们不妨以勒贝格测度为例列一张表格:
\begin{center}
    \begin{tabular}{ |c|c|c|c| } 
    \hline
    函数 & 对应的``图形" & 对应的集族(定义域) & 如何得到 \\ 
    \hline
    体积 & 开区间 & 所有开区间构成的集族$\calQ$  & 生活经验 \\ 
    \hline
    外测度 & 任一子集 & 幂集$\calP(\R^n)$ & 可数多个开区间的覆盖取下确界 \\ 
    \hline
    测度 & 可测集 & Lebesgue $\sigma$-代数$\calL$ & Carath\'eodory条件 \\
    \hline
    \end{tabular}
\end{center}
先从最基本的具有先验体积的图形\footnote{大家可以直接想象成方体}出发(building block), 我们手头上就有了一个定义在$\calQ$上的体积函数$\rho$, 且这个函数自然地满足有限可加性(有限多个不交的区间的体积等于各自体积之和). 接着用可数多个区间覆盖任一集合, 对这些区间体积和取下确界得到定义在$\calP(\R^n)$上的函数: 外测度$m^*$. 最后, 用某些条件去限制一个集合满足关于$m^*$的某个不等式, 从而缩小$\calP(\R^n)$的范围, 得到可测集类, 同时也是个$\sigma$-代数.\footnote{如果感到这段话难以理解, 请学习正课对应的内容}

在抽象测度论中我们将会学习如何构造一个测度, 也是从简单到复杂, 分为4个步骤\footnote{此处为预告, 不需要掌握. 半代数和代数也是类似于$\sigma$-代数的一种结构}:
\begin{center}
    (体积, 半代数) $\rightarrow$ (预测度, 代数) $\rightarrow$ (外测度, 幂集) $\rightarrow$ (测度, $\sigma$-代数)
\end{center}
相信大家在学习抽象测度论时, 不会感到陌生. 

最后, 我们再了解一下外测度的公理化定义(外测度在实际应用中基本都是基本图形覆盖+下确界这一套组合, 很少出现纯种的抽象外测度). 总结一下勒贝格外测度的性质, 我们将其推广至一般的集合$X$. 
若$\mu^*: \calP(X) \to [0, \infty]$满足
\begin{enumerate}
    \item $\mu^*(\varnothing) = 0$;
    \item $A \subset B \implies \mu^*(A) \leq \mu^*(B)$;
    \item $\mu^*\br{\bCup{n=1}{\infty}A_n} \leq \Sum{n=1}{\infty} \mu^*(A_n)$,
\end{enumerate}
则称$\mu^*$为$X$上的一个外测度. 

\begin{exercise}
    设$\mu^*$是$X$上的一个外测度.
    设$B \subset X$. 定义$\mu_B: \calP(X) \to [0, \infty]$如下:
    $$\mu_B(A) = \mu^*(A \cap B).$$
    验证: $\mu_B$也是$X$上的一个外测度. 
\end{exercise}
\begin{proof}
    显然$\mu_B(\varnothing) = 0$. 设$E \subset F$, 则
    $E \cap B \subset F \cap B$, 所以$\mu^*(E \cap B) \leq \mu^*(F \cap B)$, 即$\mu_B(E) \leq \mu_B(F)$. 设$\{E_n\}_{n=1}^\infty$为$X$中的一列集合, 则$\mu_B\br{\bCup{n=1}{\infty}E_n} = \mu^*\br{ \br{\bCup{n=1}{\infty}E_n} \cap B}$.
    因为$\bCup{n=1}{\infty}E_n \cap B = \bCup{n=1}{\infty}(E_n \cap B)$, 所以利用$\mu^*$已经是外测度这一条件得
    $$\mu_B\br{\bCup{n=1}{\infty}E_n} = \mu^*\br{\bCup{n=1}{\infty}(E_n \cap B)} \leq \Sum{n=1}{\infty} \mu^*(E_n \cap B) = \Sum{n=1}{\infty} \mu_B(E_n). $$
    \qed 
\end{proof}
\begin{exercise} % Stein 1-26
    设$A \subset E \subset B$, $A,B$具有有限测度. 证明: 若$m(A) = m(B)$, 则$E$可测.
\end{exercise}
\begin{proof}
    因为$m(E \setminus A) \leq m(B \setminus A) = m(B) - m(A) = 0$, 所以$E \setminus A$可测, 
    从而$E = A \cup (E \setminus A)$可测. \qed 
\end{proof}


\subsection{其他外测度限制条件}
阅读过不止一本实分析教材的同学可能会发现, 在限制外测度的定义域时, 除了用Carath\'eodory条件, 还有别的限制方式. Stein的\textit{Real Analysis}是这样定义可测集的:
设$E$是一个集合, 若对任意$\eps > 0$都存在一个开集$U \supset E$, 使得$m^*(U \setminus E) < \eps$, 则称$E$为(勒贝格)可测集. 这种定义方式更符合几何直觉: 如果一个开集能够``较好地"盖住集合$E$, 那么$E$就是可测的, 且定义勒贝格测度$m(E) = m^*(E)$. 从该定义出发, 我们同样能够证明可测集类的封闭性以及$m$的可数可加性, 这里以并集为例:
\begin{example}
    利用另一种可测集的定义, 证明: 设$\{E_n\}_{n=1}^\infty$为一列可测集, 则$\bCup{n=1}{\infty}E_n$可测.
\end{example}
\begin{proof}
    首先, 对每个$n \in \N$都存在$U_n$使$m^*(U_n \setminus E_n) < 2^{-n} \eps$.
    显然$\bCup{n=1}{\infty}U_n \supset \bCup{n=1}{\infty}E_n$, 且
    $\bCup{n=1}{\infty}U_n \setminus \bCup{n=1}{\infty}E_n = \bCup{n=1}{\infty} (U_n \setminus E_n)$, 所以
    $$  m^*\br{\bCup{n=1}{\infty}U_n \setminus \bCup{n=1}{\infty}E_n}
    \leq \Sum{n=1}{\infty}m^*\br{U_n \setminus E_n} < \eps. $$
    \qed 
\end{proof}
在``开集逼近"这一定义下, 大部分可测集的性质证明都是传统的$\eps$方法, 而在Carath\'eodory条件的框架下, 证明则更多的是一路等于号的代数变形. 

我们现在来聊聊更深层次的区别: 
Carath\'eodory条件是一个等式, 而且对任意集合都能用. 开集逼近条件则要求我们的原始集合上要具备一个拓扑(开集是拓扑中的元素). 当然在$\R$中这个差别体现不出来, 但当我们要在更一般的集合$X$上构造测度时, 几乎就只能采用Carath\'eodory条件, 因为它只涉及到代数运算. 我们在学习抽象测度构造方法论时, 还会再见到Carath\'eodory条件. 

最后, 你一定想问: 这两种定义等价吗? 这里我们需要借助勒贝格测度的\textbf{正则性质}. 从开集逼近定义出发, 对每个$n \in \N$我们都能找到$U_n \supset E$满足$m^*(U_n \setminus E) < 1/n$, 令$U = \bCap{n=1}{\infty}U_n$, 则$m^*(U \setminus E) = 0$, 于是$E = U \setminus (U \setminus E)$具有$G_\delta \setminus$(0测集)的形式, 所以$E$可测, 自然满足Carath\'eodory条件. 反过来, 正课中我们从Carath\'eodory条件出发推得的一条正则性质($\forall \eps>0~\exists$开集$U \supset E: m^*(U \setminus E)<\eps$)正是开集逼近条件.

\begin{remark}
    为保证行文连贯, 我在讲义写正则性质与测度的极限运算之前用到了这些结果, 如读者在这里对它们感到陌生, 请调整阅读顺序. 
\end{remark}




\subsection{无交化处理与Venn图}
实分析会牵涉到大量的集合运算, 与此同时我们还要估计这些集合的测度. 
由于测度对互不相交的集合列具有可数可加性, 在应用中我们常常要想方设法将一个集合写成无交并的形式, 例如
$$E \cup F = (E \setminus F) \cup (E \cap F) \cup (F \setminus E) = (E \Delta F) \cup (E \cap F).$$
这个式子在集合论上虽然正确, 但是对测度论却没有什么价值, 因为$\mu(E \setminus F)$并不一定等于$\mu(E) - \mu(F)$: 我们减得太``多"了.
$E$可以写成无交并$$E=(E \setminus (E \cap F)) \cup (E \cap F),$$ 
$F$可以写成无交并$$F=(F \setminus (E \cap F)) \cup (E \cap F),$$
从而
$$E \cup F = (E \setminus (E \cap F)) \cup (E \cap F) \cup (F \setminus (E \cap F)). $$

\begin{exercise}
    假设上面出现的集合均可测(一般的可测), 将测度$\mu$套到等号两边, 写出测度作用与集合运算的恒等式. 
\end{exercise}
% 在解答中穿插Venn图的应用
\begin{exercise}\label{inclu-exclu-basic-case}
    设$E,F \subset X$为可测集, 则$\mu(E)+\mu(F) = \mu(E \cup F) + \mu(E \cap F)$.
\end{exercise}
\begin{proof}
    若$E$和$F$的其中一个测度为$\infty$, 则显然$\infty = \infty$. 现设$\mu(E)<\infty, \mu(F)<\infty$ (想做减法, 就必须保证有限, 因为$\infty - \infty$没有定义, 所以不能出现这种样子的表达式). \\
    记$A = E \cap F$, 则
    \begin{align*}
    %\mu(E \cup F)
    %&= \mu(E \cup (F \setminus A)) = \mu(E) + \mu(F \setminus A), \\
    \mu(E \cup F)
    &= \mu(F \cup (E \setminus A)) = \mu(F) + \mu(E \setminus A) \\
    \mu(E) &= \mu((E \setminus A) \cup A)
    = \mu(E \setminus A) + \mu(E \cap F). 
    \end{align*}
    两式相减得结论. \qed 
\end{proof}
\begin{remark}
    从直觉上看, 将$E$的测度和$F$的测度相加, 则会多加一次$E \cap F$的测度, 所以要将其减去, 这样就有
    $\mu(E \cup F) = \mu(E) + \mu(F) - \mu(E \cap F)$. 
\end{remark}
\begin{example}
    设$E,F \subset X$为可测集. 
    \begin{enumerate}
    \item 若$\mu(E \Delta F) = 0$, 则$\mu(E)=\mu(F)$. ($E \Delta F = (E \setminus F) \cup (F \setminus E)$).
    \item 若$\mu(E \Delta F) = 0$, 则称$E \sim F$. 证明$\sim$是$\sigma$-代数$\calM$上的一个等价关系. 
    \end{enumerate}
\end{example}
\begin{proof}
    \begin{enumerate}
    \item 我们并不能直接把测度套用在$E \Delta F$的原始定义上, 因为$\mu(E \setminus F)$一般不等于$\mu(E)-\mu(F)$. 记$A=E \cap F$, 则
    $$E \Delta F = (E \setminus A) \cup (F \setminus A), $$
    所以$\mu(E \Delta F) = \mu(E \setminus A) + \mu(F \setminus A) = 0$, 从而
    $\mu(E \setminus A) = \mu(F \setminus A) = 0$.
    于是
    \begin{align*}
        &\mu(E) = \mu(E \setminus A) + \mu(A) = \mu(A), \\
        &\mu(F) = \mu(F \setminus A) + \mu(A) = \mu(A).
    \end{align*}
    \item 显然$\mu(E \Delta E) = 0$. 若$\mu(E \Delta F) = 0$, 则$\mu(F \Delta E) = \mu(E \Delta F) = 0$. 现设$E \sim F, F \sim G$, 则$\mu(E \Delta F) = \mu(F \Delta G) = 0$, 想要证$\mu(E \Delta G) = 0$. 
    我们的思路自然是将$E\Delta G$写成无交并: 先画出$E, F, G$的Venn图, 写出每一个交集, 最后代入$E \Delta G$.
    \begin{figure}[h]
        \centering
        \includegraphics[scale=0.6]{figure/Venn_1.png}
        %\caption{Caption}
    \end{figure}
    
    令
    \begin{align*}
        &A = E \cap F \cap G, \\
        &B_1 = (E \cap F) \setminus A, \quad B_2 = (E \cap G) \setminus A, \quad B_3 = (F \cap G) \setminus A, \\
        &E_1 = E \setminus (B_1 \cup B_2 \cup A), \quad
         F_1 = F \setminus (B_1 \cup B_3 \cup A), \quad
         G_1 = G \setminus (B_2 \cup B_3 \cup A).
    \end{align*}
    则由条件知
    \begin{align*}
        &\mu(E_1 \cup B_2) + \mu(F_1 \cup B_3) = \mu(E_1)+\mu(B_2)+\mu(F_1)+\mu(B_3)=0, \\
        &\mu(F_1 \cup B_1) + \mu(G_1 \cup B_2) = \mu(F_1)+\mu(B_1)+\mu(G_1)+\mu(B_2)=0,
    \end{align*}
    则
    $$\mu(E \Delta G)
    = \mu(E_1 \cup B_1)+\mu(G_1 \cup B_3) 
    = \mu(E_1) + \mu(B_1) + \mu(G_1) + \mu(B_3) = 0. $$
    \end{enumerate}
    \qed 
\end{proof}
\begin{example}[~容斥原理(inclusion–exclusion principle)]
    现在我们介绍概率论中常用的\textbf{容斥原理}. 为此, 我们先引入概率测度$\P$. 设$(X, \calF, \P)$为一测度空间, 如果测度$\P$满足$\P(X) = 1$, 则称$(X,\calF,\P)$为一个\textbf{概率空间}(probability space), $\P$为其上的一个\textbf{概率测度}(probability measure), 简称概率. 令练习 \ref{inclu-exclu-basic-case} 中的$\mu$为概率测度$\P$可得两个集合的容斥原理
    $$\P(E \cup F) = \P(E)+\P(F) - \P(E \cap F). $$
    再次利用上一个例子中的Venn图, 我们有
    \begin{align*}
        E \cup F \cup G
        &= E \cup F_1 \cup B_3 \cup G_1 \\
        &= E \cup (F \setminus (A \cup B_1)) \cup (G \setminus (B_2 \cup B_3 \cup A)) \\
        &= E \cup (F \setminus (E \cap F)) \cup (G \setminus (B_2 \cup B_3 \cup A)), 
    \end{align*}
    则
    \begin{align*}
        \P(E \cup F \cup G)
        &= \P(E) + \P(F) - \P(E \cap F) + \P(G) - \P(B_2 \cup B_3 \cup A) \\
        &= \P(E)+\P(F)+\P(G) - \P(E \cap F) - [\P( (B_2 \cup A) \cup (B_3 \cup A) )] \\
        &= \P(E)+\P(F)+\P(G) - \P(E \cap F) - [\P( (B_2 \cup A) + \P(B_3 \cup A) - \P(A)] \\
        &= \P(E)+\P(F)+\P(G) - \P(E \cap F) - \P(E \cap G) - \P(F \cap G) + \P(E \cap F \cap G).
    \end{align*}
    但是对$n$个集合的情形, 我们就不能画Venn图了, 需要用数学归纳法. 一般地, 设$A_1, \cdots, A_n \in \calF$, 则
    \begin{equation}
    \P\br{\bCup{i=1}{n}A_i}
    = \Sum{i=1}{n}\P(A_i) - \sum_{i<j}\P(A_i \cap A_j) 
    + \sum_{i<j<k}\P(A_i \cap A_j \cap A_k) + \cdots + 
    (-1)^{n-1}\P\br{\bCap{i=1}{n}A_i}.
    \end{equation}
\end{example}
\begin{proof}
    假设容斥原理对$n$成立, 我们只需证明它对$n+1$也成立. 
    因为$\bCup{i=1}{n+1}A_i = \bCup{i=1}{n}A_i \cup A_{n+1}$, 所以我们可以套用$n=2$的容斥原理, 得
    $$\P\br{\bCup{i=1}{n}A_i \cup A_{n+1}}
    = \P\br{\bCup{i=1}{n}A_i} + \P(A_{n+1}) - \P\br{\bCup{i=1}{n}A_i \cap A_{n+1}}. $$
    这样右边最多就只有$n$个集合的并, 所以由归纳假设得
    \begin{align*}
    \P\br{\bCup{i=1}{n}A_i \cap A_{n+1}}
    &= \R\br{\bCup{i=1}{n} (A_i \cap A_{n+1})} \\
    &= \Sum{i=1}{n}\P(A_i \cap A_{n+1}) - \sum_{i<j \leq n}\P(A_i \cap A_j \cap A_{n+1}) 
    + \cdots + 
    (-1)^{n-1}\P\br{A_1 \cap \cdots \cap A_n \cap A_{n+1}},
    \end{align*}
    还有
    \begin{align*}
    \P\br{\bCup{i=1}{n}A_i}
    = \Sum{i=1}{n}\P(A_i) - \sum_{i<j \leq n}\P(A_i \cap A_j) 
    + \cdots + (-1)^{n-1}\P\br{A_1 \cap \cdots \cap A_n}.
    \end{align*}
    将上面两式相加, 得
    \begin{align*}
    \P\br{\bCup{i=1}{n}A_i \cup A_{n+1}}
    &= \Sum{i=1}{n+1}\P(A_i) - \sum_{i<j\leq n+1}\P(A_i \cap A_j)
    + \cdots \\
    &\quad + (-1)^{n-1}[\P(A_1 \cap \cdots \cap A_{n-1} \cap A_n) + 
                        \P(A_1 \cap \cdots \cap A_{n-1} \cap A_{n+1})] \\
    &\quad + (-1)^n \P(A_1 \cap \cdots \cap A_{n+1}),
    \end{align*}
    故容斥原理对$n+1$也成立, 所以对所有$n \in \N^+$都成立. \qed 
\end{proof}

%在利用Carath\'eodory条件证明勒贝格可测集对交, 并, 补的封闭性时,  也用到了这一思想. 
\subsection{Carath\'eodory条件中试验集的选取}
设$A \subset \R$, 若对任意集合$E \subset \R$, 有
\begin{equation}
    m^*(E) = m^*(E \cap A) + m^*(E \cap A^c), 
\end{equation}
则称$A$为勒贝格可测集, 而$E$一般可叫作\textbf{试验集}. 许多关于集合可测性结论的证明, 都依赖于试验集的巧取. 
\begin{exercise}[~(复习)]
    设$m^*$是$\R$上的勒贝格外测度, $A,B$为勒贝格可测集, 证明$A \cup B$也是勒贝格可测集. 
\end{exercise}
\begin{proof}
    设$E \subset \R$, 则
    \begin{align*}
    m^*(E) &= m^*(E \cap A) + m^*(E \cap A^c),
    \end{align*}
    因为$B$是可测集, 所以$B$满足Carath\'eodory条件, 分别取两个特殊的\textbf{试验集}$E \cap A$和$E \cap A^c$, 有
    \begin{align*}
    &m^*(E \cap A) = m^*((E \cap A) \cap B) + m^*((E \cap A) \cap B^c) \\
    &m^*(E \cap A^c) = m^*((E \cap A^c) \cap B) + m^*((E \cap A^c) \cap B^c).
    \end{align*}
    于是, 我们有
    $$ m^*(E) =  m^*(E \cap A \cap B) + m^*(E \cap A \cap B^c) + 
    m^*(E \cap A^c \cap B) + m^*(E \cap A^c \cap B^c), $$
    不难发现
    $$(E \cap A \cap B) \cup (E \cap A \cap B^c) \cup (E \cap A^c \cap B) \supset E \cap (A \cup B), $$
    所以由外测度的单调性得
    $$ m^*(E) \geq m^*(E \cap (A \cup B)) + m^*(E \cap (A \cup B)^c). $$
    \qed 
\end{proof}


\begin{example}\label{Caratheodory_thm}
    对集合$X$上的抽象外测度$\mu^*$, 我们也有Carath\'eodory条件, 还会给满足这个条件的集合起个新名字. 若集合$A \subset X$满足
    $$\mu^*(E) = \mu^*(E \cap A) + \mu^*(E \cap A^c) \text{ 对所有 }E \subset X\text{ 都成立},$$
    则称$A$是$\mu^*$-\textbf{可测}的. 设$\calM$是由所有$\mu^*$-可测集构成的集族, 则$\calM$是一个$\sigma$-代数.
\end{example}
\begin{proof}
    若$A,B \in \calM$, 则将上一条练习中的$m^*$改成$\mu^*$得$A \cup B \in \calM$. 现在我们证明对任意两两不交的可测集列$\{A_j\}_{j=1}^{\infty}$, 有$\bCup{j=1}{\infty}A_j \in \calM$. 也就是说, 我们要证明
    $$\mu^*(E) \geq \mu^*\br{E \cap \bCup{j=1}{\infty}A_j} + \mu^*\br{E \cap \bCap{j=1}{\infty}A_j^c}. $$
    我们先从有限多个的情形入手. 设$B_n = \bCup{j=1}{n}A_j, B = \bCup{j=1}{\infty}A_j$, 则对可测集$A_n$取\textbf{试验集}$E \cap B_n$, 得
    \begin{align*}
    \mu^*(E \cap B_n) &= \mu^*(E \cap B_n \cap A_n) + \mu^*(E \cap B_n \cap A_n^c) \\
    &= \mu^*(E \cap A_n) + \mu^*(E \cap B_{n-1}).
    \end{align*}
    同样, $\mu^*(E \cap B_{n-1}) = \mu^*(E \cap A_{n-1}) + \mu^*(E \cap B_{n-2})$. 故由数学归纳法得
    $$\mu^*(E \cap B_n) = \Sum{j=1}{n} \mu^*(E \cap A_j). $$
    因为每个$A_n$都是可测集, 所以$B_n$也是可测集, 选取\textbf{试验集}$E$得
    \begin{align*}
    \mu^*(E) &= \mu^*(E \cap B_n) + \mu^*(E \cap B_n^c) \\
    &\geq \Sum{j=1}{n}\mu^*(E \cap A_j) + \mu^*(E \cap B_c).
    \end{align*}
    令$n \to \infty$, 得
    \begin{align*}
    \mu^*(E) 
    &\geq \Sum{j=1}{\infty}\mu^*(E \cap A_j) + \mu^*(E \cap B^c) \\
    &\geq \mu^*\br{\bCup{j=1}{\infty}(E \cap A_j)} + \mu^*(E \cap B^c) \\
    &= \mu^*(E \cap B) + \mu^*(E \cap B^c) \geq \mu^*(E). 
    \end{align*}
    这就证明了$B=\bCup{j=1}{\infty}A_j$满足Carath\'eodory条件, 所以$B \in \calM$.  \qed 
\end{proof}
\begin{exercise}
    我们知道外测度$\mu^*$的定义域是$X$的所有子集构成的集族$\calP(X)$, 而测度则需要由外测度限制而来. 符号书接上例, 证明:
    $\mu^*$限制在$\sigma$-代数$\calM$上是一个测度. 
\end{exercise}
\begin{proof}
    因为$E$可以任取, 所以令$E=B$, 得
    $$\mu^*\br{\bCup{j=1}{\infty}A_j} = \Sum{j=1}{\infty}\mu^*(A_j), $$
    故$\mu^*$在$\calM$上满足可数可加性, 所以$\mu^*|_\calM$是一个测度. \qed 
\end{proof}
\begin{exercise}
    设$\mu^*$是集合$X$上的一个外测度, $\{A_j\}_{j=1}^\infty$为一列互不相交的$\mu^*$-可测集. 证明对任意$E \subset X$, 有
    $$\mu^*\br{E \cap \br{\bCup{j=1}{\infty}A_j} } = \Sum{j=1}{\infty}\mu^*(E \cap A_j). $$
\end{exercise}
%\begin{proof}
    %由外测度的可数次可加性得
    %$$\mu^*\br{E \cap \br{\bCup{j=1}{\infty}A_j} } \leq \Sum{j=1}{\infty}\mu^*(E \cap A_j),$$
    %所以另一个方向会比较难.
    %设$B_n = \bCup{j=1}{n}A_j, B = \bCup{j=1}{\infty}A_j$,则
    %\begin{align*}
    %\mu^*(E \cap B_n) &= \mu^*(E \cap B_n \cap A_n) + \mu^*(E \cap B_n \cap A_n^c) \\
    %&= \mu^*(E \cap A_n) + \mu^*(E \cap B_{n-1}).
    %\end{align*}
    %类似地, $\mu^*(E \cap B_{n-1}) = \mu^*(E \cap A_{n-1}) + \mu^*(E \cap B_{n-2})$. 故由数学归纳法得
    %$$\mu^*(E \cap B_n) = \Sum{j=1}{n} \mu^*(E \cap A_j). $$
    %因为$\mu^*$-可测集构成的集族是一个$\sigma$-代数, 所以$B_n, B$都是$\mu^*$-可测的, 于是根据Carath\'eodory条件, 得
    %由外测度的单调性, 可得
    %$$\mu^*(E \cap B) \geq \mu^*(E \cap B_n) = \Sum{j=1}{n} \mu^*(E \cap A_j) $$
    %令$n \to \infty$, 得
    %$$\mu^*(E \cap B) \geq \Sum{j=1}{\infty} \mu^*(E \cap A_j), $$
    %这就是另一个方向的不等式. \qed 
%\end{proof}

% ============== input: Cantor set and Borel measure
\input{1 measure/Cantor_set.tex}
\input{1 measure/Borel_measure.tex}

\section{可测集与测度的性质}
\subsection{点集间的距离}
我们先补充一些预备知识. 如果你已对此节内容比较熟悉, 请速速跳过.
首先定义点与集合间的距离. 设$E \subset \R^n, x \in \R^n$, 定义$x$与$E$的\textbf{距离}为
$$d(x,E) = \inf_{y \in E} |x-y|, $$
其中$|x-y| = \sqrt{(x_1-y_1)^2 + \cdots + (x_n-y_n)^2}$.
\begin{example}
    设$E \subset \R^n$, 则$d(x,E) = 0 \iff x \in \cl{E}$. 
\end{example}
\begin{proof}
    若$x \in \cl{E}$, 则存在$\{y_n\} \subset E$使得$\lim_{n \to \infty}y_n = x$, 所以$\inf_{n \in \N}|x-y_n| = 0$, 故$d(x,E) = 0$. 反过来, 若$\inf_{y \in E}|x-y| = 0$, 则存在$E$中的点列$\{y_n\}$满足$|y_n - x| \to 0$, 所以$x \in \cl{E}$. \qed 
\end{proof}
\begin{exercise}
    设$F \subset \R^n$为闭集, 则$d(x,F) = 0 \iff x \in F$.
\end{exercise}
\begin{exercise}
    证明: $d(x,E) = d(x, \cl{E})$. 
\end{exercise}
\begin{example}
    固定集合$E \subset \R^n$, 我们可以将$d(x,E)$看作$x$的函数, 即定义
    \begin{align*}
        f: \R^n &\to [0,\infty) \\
        f(x) &= d(x,E).
    \end{align*}
    证明: $f$是一个连续函数. 
\end{example}
\begin{proof}
    设$x_n \to x$, 我们证明$d(x_n,E) \to d(x,E)$. 设$y \in E$, 则$|x-y| \leq |x-x_n| + |x_n-y|$, 从而
    \begin{align*}
        &|x-y|-|x_n-y| \leq |x-x_n|, \\
        &|x_n-y| - |x-y| \geq -|x-x_n|.
    \end{align*}
    设$\eps>0$, 则存在$N \in \N$使得$|x_n - x|<\eps~\forall n > N$. 从而
    \begin{align*}
        &|x_n-y| \leq \eps + |x-y|, \\
        &|x_n-y| \geq |x-y|-\eps.
    \end{align*}
    两边对$y$取下确界得
    \begin{align*}
        &d(x_n,E)-d(x,y) \leq \eps, \\
        &d(x_n,E)-d(x,y) \geq -\eps.
    \end{align*}
    也就是说, 对任意$\eps>0$都存在$N\in\N$使得$n>N$时, $|d(x_n,E)-d(x,y)| \leq \eps$, 所以
    $$\limsup_{n\to \infty}|d(x_n,E)-d(x,y)|=0. $$
    由归结原则知$f(x)=d(x,E)$连续. \qed    
\end{proof}
今后我们会利用距离函数的连续性(开集的原像是开集)构造一些开集, 例如$U_n := \{x \in \R^n: d(x,E) < 1/n\}$.

现在看点集与点集间的距离. 我们的定义还是基于点与点的距离, 不过这次要让两个点都动起来. 设$E,F \subset \R^n$, 定义$E$与$F$的\textbf{距离}为
$$d(E,F) = \inf\{|x-y|: x \in E, y \in F\}.$$

对单独的一个集合$A$, 定义其\textbf{直径}(diameter)为$d(A) = \sup_{x,y \in A} |x-y|$. 由于不会引起歧义, 我们仍采用字母$d$. 
\subsection{测度的单调收敛定理}
设$E_1 \subset E_2 \subset \cdots $为一单调递增的集列, 记$E = \bigunion{n=1}{\infty}E_n$, 则
$$m(E)=\lim_{n \to \infty}m(E_n).$$
若使用集合列极限的记号, 上式可以写得更直观:
$$m(E)=m\left(\bigunion{n=1}{\infty}E_n\right)=m(\Lim{n}{\infty}E_n) = \Lim{n}{\infty}m(E_n).$$
设$F_1 \supset F_2 \supset \cdots $为一单调递减的集列且$m(F_1)<\infty$,
记$F = \bigintersect{n=1}{\infty}F_n$, 则
$$m(F)=\lim_{n \to \infty}m(F_n).$$
等式也可以写成:
$$m(F)=m\left(\bigintersect{n=1}{\infty}F_n\right)=m(\Lim{n}{\infty}F_n) = \Lim{n}{\infty}m(F_n).$$
\begin{exercise}
    在$\R$中试找出一列$\{F_n\}_{n=1}^\infty,$ 但$m(F_1)=\infty$, 
    使得$m\br{\bCap{n=1}{\infty}F_n} \neq \lim_{n \to \infty}m(F_n)$.
\end{exercise}
% 18.8


\subsection{勒贝格可测集的正则性质}
由于$\R^n$具备天然的拓扑结构(由欧几里得范数$\|x\|=\sqrt{x_1^2 + \cdots + x_n^2}$所引出), 我们可以用熟悉的集合(开集, 闭集, 紧集)逼近一般的勒贝格可测集. 
设$E$是$\R^n$中的一个可测集, 则对任意$\eps>0$:
\begin{enumerate}
    \item 存在开集$U \supset E$使$m(U \setminus E)\leq \eps$.
    \item 存在闭集$F \subset E$使$m(E \setminus F)\leq \eps$.
    \item 若$m(E)<\infty$, 则存在紧集$K\subset E$使$m(E \setminus K) \leq \eps$. 
    %\item 若$m(E)<\infty$, 则存在有限多个方体$\{Q_j\}_{j=1}^N$使
    %$$m\left(E \Delta \bigunion{j=1}{N}Q_j\right) \leq \eps.$$
\end{enumerate}
如果将$\eps$离散化, 即对每个$n \in \N$存在开集$U_n \supset E$使$m(U_n \setminus E) \leq 1/n$, 然后取极限(相关证明参见正课), 我们可以将勒贝格可测集表达成一个博雷尔集并上或减去一个零测集的形式:
\begin{enumerate}
    \item $E \subset \R^n$可测当且仅当$E=G \setminus N$, 其中$G$是一个$G_\delta$集, $N$是一个零测集;
    \item $E \subset \R^n$可测当且仅当$E=F \cup M$, 其中$F$是一个$F_\sigma$集, $M$是一个零测集. 
\end{enumerate}
后续我们会学习定义在可测集上的函数以及在可测集上做积分, 研究这些函数和积分的性质时我们往往会遵循从简单到复杂的顺序: 
方体$\rightarrow$开集$\rightarrow$可数个开集的交($G_\delta$)$\rightarrow$可测集. 现在请大致在脑海中留下这个印象: “勒贝格可测集可以表达成更简单的形式”. 不必强行记忆这6条性质(但是要确保自己动手证明过一遍), 它们会在后续内容中反复出现, 等你学完实分析之后就会发现自己根本忘不掉! 
\begin{exercise} % Stein 1-25
    可测性的另一种等价定义: 若对任意$\eps>0$都存在闭集$F \subset E$, 使得$m^*(E \setminus F) < \eps$, 则$E$可测. 证明该定义与``开集逼近"条件等价.     
\end{exercise}
\begin{proof}
    提示: 注意到$U \setminus E = U \cap E^c = E^c \cap (U^c)^c = E^c \setminus U^c$.
\end{proof}
\begin{exercise}
    给定集合$E$, 设
    $$U_n = \{x: d(x,E)<1/n\}.$$ 证明
    \begin{enumerate}
    \item 如果$E$是紧集, 则$m(E)=\lim_{n\to \infty}m(U_n)$.
    \item 如果$E$闭且无界, 则结论不一定成立.
    \item 如果$E$开且有界, 则结论不一定成立.
    \end{enumerate}
\end{exercise}
\begin{proof}
    \begin{enumerate}
    \item 显然$U_1 \supset U_2 \supset \cdots$为一递减集列, 且因为$E$是紧集, 所以$m(U_1) < \infty$. 
    现在只需证$E = \bCap{n=1}{\infty}\{x:d(x,E) < 1/n\}$. 设$x \in E$, 则$d(x,E)=0$. 设$x \in  \bCap{n=1}{\infty}\{x:d(x,E) < 1/n\}$, 则$d(x,E) < 1/n~\forall n \in \N$, 故$d(x,E) = 0$, 所以$x \in \cl{E} = E$. 
    \item 令$E = \Z$, 则对每个$n \in \N$, 都有
    $$m(U_n) \geq \frac{2}{n} \cdot n = 2, $$
    而$m(E) = 0$. 
    \item 注意到$\cl{E}$是紧集, 所以(1)对$\cl{E}$成立, 于是问题肯定出在$\partial E$上, 故联想到稠密性. 记$D=(0,1) \cap \Q = \{r_1, r_2, \cdots\}$, 令$\eps < 1$, 对每个$r_n$, 令$E_n = (r_n - 2^{-n}\eps, r_n + 2^{-n}\eps)$, 则$E := (\bCup{n=1}{\infty}E_n) \cap (0,1)$是开集, 
    且$$ 1 = m([0,1]) = m(\cl{E}) = \lim_{n \to \infty}m(U_n), $$
    但是$m(E) < \eps$. \qed 
    \end{enumerate}
\end{proof}

现在我们略微研究一下$G_\d$和$F_\sigma$集.
\begin{exercise}\footnote{本练习第2条需要用到Baire纲定理, 可跳过.}
    \begin{enumerate}
    \item 证明闭集都是$G_\d$集, 开集都是$F_\sigma$集.
    \item 想出一个不是$G_\d$集的$F_\sigma$集.
    %\item 想出一个既不是$G_\d$也不是$F_\sigma$的博雷尔集. 
    \end{enumerate}
\end{exercise}
\begin{proof}
    \begin{enumerate}
    \item 设$F$是一个闭集, 令$U_n = \{x: d(x,F) < 1/n\}$, 则$U_n$是开集, 且$F = \bCap{n=1}{\infty}U_n$. 任一开集都可以写成可数个闭方体的并, 所以为$F_\sigma$集. 
    \item 我们证明有理数集$\Q$满足要求. 首先, $\Q = \bCup{n=1}{\infty}\{r_n\}$显然是个$F_\sigma$集. 
    \end{enumerate}
\end{proof}
\begin{exercise} % Stein 1.27
    设$E_1,E_2$为$\R$中的紧集, $E_1 \subset E_2$. 令$a = m(E_1), b = m(E_2)$. 
    证明: 对任意$c \in (a,b)$, 都存在紧集$E$满足$E_1 \subset E \subset E_2$且$m(E)=c$. 
    (提示: 如果$E$为$[0,1]$的可测子集, 考虑$t$的函数$m(E \cap [0,t])$)
\end{exercise}

% 18.13
